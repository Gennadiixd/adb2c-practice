import { Client } from "@microsoft/microsoft-graph-client";

const tenantName = "sandboxfortest";
const accessToken =
  "eyJ0eXAiOiJKV1QiLCJub25jZSI6Im1QSGRwOG5KYnFUQ3ZXajg4ZXlpcjdNdy00ckpvRGNfTk9SNS1vUVcwUXciLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9mNTVlYTVjNi0xODkzLTQxZjItYjNmMC03OGJhOWQ3ZjUwZjQvIiwiaWF0IjoxNjcxMTIzNzY0LCJuYmYiOjE2NzExMjM3NjQsImV4cCI6MTY3MTEyNzY2NCwiYWlvIjoiRTJaZ1lQaXRzRFZnYW9HbmdsZTlnV2VnOFI5VEFBPT0iLCJhcHBfZGlzcGxheW5hbWUiOiJxd2VyYXNkZiIsImFwcGlkIjoiOTQzM2Y3YjUtNGI3Yi00NjJhLWI3MTQtNzM1OGQ4ODRjMWUwIiwiYXBwaWRhY3IiOiIxIiwiaWRwIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvZjU1ZWE1YzYtMTg5My00MWYyLWIzZjAtNzhiYTlkN2Y1MGY0LyIsImlkdHlwIjoiYXBwIiwib2lkIjoiMmMwYjMzMTUtNjVjNy00NGFmLTk0N2MtYjc3MjM3MGIyNWJiIiwicmgiOiIwLkFSMEF4cVZlOVpNWThrR3o4SGk2blg5UTlBTUFBQUFBQUFBQXdBQUFBQUFBQUFBZEFBQS4iLCJyb2xlcyI6WyJVc2VyLlJlYWRCYXNpYy5BbGwiLCJVc2VyLlJlYWRXcml0ZS5BbGwiLCJVc2VyLkludml0ZS5BbGwiLCJVc2VyLlJlYWQuQWxsIiwiVXNlci5FeHBvcnQuQWxsIiwiVXNlci5NYW5hZ2VJZGVudGl0aWVzLkFsbCJdLCJzdWIiOiIyYzBiMzMxNS02NWM3LTQ0YWYtOTQ3Yy1iNzcyMzcwYjI1YmIiLCJ0ZW5hbnRfcmVnaW9uX3Njb3BlIjoiTkEiLCJ0aWQiOiJmNTVlYTVjNi0xODkzLTQxZjItYjNmMC03OGJhOWQ3ZjUwZjQiLCJ1dGkiOiJuOGFHWHMwdzBVS3dzTmhYaXdHa0FBIiwidmVyIjoiMS4wIiwid2lkcyI6WyIwOTk3YTFkMC0wZDFkLTRhY2ItYjQwOC1kNWNhNzMxMjFlOTAiXSwieG1zX3RjZHQiOjE2NzA4NDI5MDl9.PHhl8ffsNj4GNwFeRXEkO-T8_C5xNdlqbIxHYdfSEMEICLWkY_ajzL-_ae3yzKhMdrtXG5VCIrRpOFR3t7MyMs5w3hxSyhio8cHNac7gBV1_HTSRYzMEv1AOzPsIKWDQ8Wnw2FRkrcvmots7WQUmp83pgHEMr3xyqISDt8cPeFZhv80Nil4tC5DGVgmLan_Gxtk13BEm14EGlU89ZBFqGCSE6Ev1uQh_meLcwnSLS_C4BEaq6K27aKSX4a6jb4k5vwRCLz2MguiJUdaBg2BRgbX3WZd7yLTZ5LUAHOUNHJZTHGxycEtdzOKMrRVH3q1xTPQQYplv-USO3xwj4uXaNg";

const client = Client.initWithMiddleware({
  authProvider: {
    getAccessToken: async () => accessToken,
  },
});

export const uploadUser = async (user) => {
  try {
    await client.api("users").create(user);
  } catch (error) {
    console.log(error);
  }
};
